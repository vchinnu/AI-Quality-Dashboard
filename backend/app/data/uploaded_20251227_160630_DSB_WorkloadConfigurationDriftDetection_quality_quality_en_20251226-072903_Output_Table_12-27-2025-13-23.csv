index,inputs.conversation_id,inputs.query,inputs.response,inputs.tool_definitions,inputs.tools_used,inputs.total_turns,inputs.turn_processing_time_ms,Passed,intent_resolution.intent_resolution.result,intent_resolution.intent_resolution.reason,coherence.coherence.result,coherence.coherence.reason,relevance.relevance.result,relevance.relevance.reason,groundedness.groundedness.result,groundedness.groundedness.reason,tool_call_accuracy.tool_call_accuracy.result,tool_call_accuracy.tool_call_accuracy.reason,task_adherence.task_adherence.result,task_adherence.task_adherence.reason,fluency.fluency.result,fluency.fluency.reason,rating,index,rating
"1","4Hvap1BGCJF3feGkdym5OD-us","[{""role"":""system"",""content"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list.""},{""createdAt"":""2025-12-26T07:29:03.965200Z"",""role"":""user"",""content"":[{""type"":""text"",""text"":""Show me configuration drifts for my SAP Workload BB4 in subscription 7235b861-9c47-4957-8841-e5f0b305a68a""}]}]","[{""createdAt"":""2025-12-26T07:29:04.965253Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_05a655b6422a42b7"",""name"":""WorkloadConfigurationDriftDetection"",""arguments"":{""message"":""Detect and list configuration drifts (configuration deviations) for the SAP workload named 'BB4' in subscription '7235b861-9c47-4957-8841-e5f0b305a68a'. Preserve the exact workload name and subscription ID; do not add or infer additional context.""}}]},{""createdAt"":""2025-12-26T07:29:06.965275Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_368679645b1f4f47"",""name"":""provide_azure_docs_assistance"",""arguments"":{""question"":""Authoritative guidance on Kusto Query Language (KQL) for Azure Resource Graph queries, focusing on: querying ExtensibilityResources table; filtering nested arrays (evaluationResults), specifically evaluationResults.configurationDeviation; projecting nested array fields evaluationResults[].name, description, checkCategory, impactLevel; filtering where workload identifier may be substring of name or match workloadSystemIdentifier; syntax for substring extraction (substring before first '-') for WVI Name; best practices for projecting only required fields and limiting results. Also include examples showing projection of nested array elements and filtering arrays with any/exists semantics.""}}]},{""createdAt"":""2025-12-26T07:29:07.965341Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_368679645b1f4f47"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""Data"":{""value"":[{""url"":""https://learn.microsoft.com/en-us/azure/service-health/resource-graph-health-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4062216,""title"":""Azure Resource Graph sample queries for Azure Resource Health"",""chunk"":""# Azure Resource Graph sample queries for Azure Resource Health\nThis page is a collection of [Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) sample queries for Azure Resource Health.\nNote\nAfter each query, you should see the updated results within 5 minutes in general.\n## Overview\nThis page helps you monitor and understand the health of your Azure services and resources using Kusto Query Language (KQL) through Azure Resource Graph.\nIt includes sample queries specifically for Azure Resource Health."",""updatedAt"":""2025-08-08T17:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#supported-kql-language-elements"",""score"":2.3592546,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\n## Supported KQL language elements\n| KQL | Resource Graph sample query | Notes| \n|  --- | --- | ---  |\n| [count](/en-us/azure/data-explorer/kusto/query/countoperator) | [Count key vaults](../samples/starter#count-key-vault-resources) |  |\n| [distinct](/en-us/azure/data-explorer/kusto/query/distinctoperator) | [Show resources that contain storage](../samples/starter#show-resources-that-contain-storage) |  |\n| [extend](/en-us/azure/data-explorer/kusto/query/extendoperator) | [Count virtual machines by OS type](../samples/starter#count-virtual-machines-by-os-type) |  |\n| [join](/en-us/azure/data-explorer/kusto/query/joinoperator) | [Key vault with subscription name](../samples/advanced#key-vaults-with-subscription-name) | Join flavors supported: [innerunique](/en-us/azure/data-explorer/kusto/query/joinoperator#default-join-flavor), [inner](/en-us/azure/data-explorer/kusto/query/joinoperator#inner-join), [leftouter](/en-us/azure/data-explorer/kusto/query/joinoperator#left-outer-join), and [fullouter](/en-us/azure/data-explorer/kusto/query/join-fullouter). Limit of three `join` or `union` operations (or a combination of the two) in a single query, counted together, one of which might be a cross-table join. If all cross-table `join` use is between *Resource* and *ResourceContainers*, then three cross-table `join` are allowed. Custom join strategies, such as broadcast join, aren't allowed. For which tables can use `join`, go to Resource Graph tables. |"",""updatedAt"":""2025-07-23T22:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.3451643,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\nThe query language for the Azure Resource Graph supports many operators and functions. Each work and operate based on [Kusto Query Language (KQL)](/en-us/azure/data-explorer/kusto/query/index). To learn about the query language used by Resource Graph, start with the [tutorial for KQL](/en-us/azure/data-explorer/kusto/query/tutorial).\nThis article covers the language components supported by Resource Graph:\n1. Understanding the Azure Resource Graph query language\n1.1. Resource Graph tables\n1.2. Extended properties\n1.3. Resource Graph custom language elements\n1.3.1. Shared query syntax (preview)\n1.4. Supported KQL language elements\n1.4.1. Supported tabular/top level operators\n1.5. Query scope\n1.6. Escape characters\n1.7. Next steps"",""updatedAt"":""2025-07-23T22:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#supported-kql-language-elements"",""score"":2.3354163,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\n## Supported KQL language elements\n| KQL | Resource Graph sample query | Notes| \n|  --- | --- | ---  |\n| [summarize](/en-us/azure/data-explorer/kusto/query/summarizeoperator) | [Count Azure resources](../samples/starter#count-azure-resources) | Simplified first page only |\n| [take](/en-us/azure/data-explorer/kusto/query/takeoperator) | [List all public IP addresses](../samples/starter#list-all-public-ip-addresses) | Synonym of `limit`. Doesn't work with [Skip](work-with-data#skipping-records). |\n| [top](/en-us/azure/data-explorer/kusto/query/topoperator) | [Show first five virtual machines by name and their OS type](../samples/starter#show-first-five-virtual-machines-by-name-and-their-os-type) |  |\n| [union](/en-us/azure/data-explorer/kusto/query/unionoperator) | [Combine results from two queries into a single result](../samples/advanced#combine-results-from-two-queries-into-a-single-result) | Single table allowed: ` | union [kind= inner | outer] [withsource=ColumnName] Table`. Limit of three `union` legs in a single query. Fuzzy resolution of `union` leg tables isn't allowed. Might be used within a single table or between the *Resources* and *ResourceContainers* tables. |\n| [where](/en-us/azure/data-explorer/kusto/query/whereoperator) | [Show resources that contain storage](../samples/starter#show-resources-that-contain-storage) |\n\nThere's a default limit of three `join` and three `mv-expand` operators in a single Resource Graph SDK query. You can request an increase in these limits for your tenant through **Help + support**.\nTo support the *Open Query* portal experience, Azure Resource Graph Explorer has a higher global limit than Resource Graph SDK.\nNote\nYou can't reference a table as right table multiple times, which exceeds the limit of 1. If you do so, you would receive an error with code DisallowedMaxNumberOfRemoteTables."",""updatedAt"":""2025-07-23T22:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#supported-kql-language-elements"",""score"":2.3293018,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\n## Supported KQL language elements\nResource Graph supports a subset of KQL [data types](/en-us/azure/data-explorer/kusto/query/scalar-data-types/), [scalar functions](/en-us/azure/data-explorer/kusto/query/scalarfunctions), [scalar operators](/en-us/azure/data-explorer/kusto/query/binoperators), and [aggregation functions](/en-us/kusto/query/aggregation-functions). Specific [tabular operators](/en-us/azure/data-explorer/kusto/query/queries) are supported by Resource Graph, some of which have different behaviors.\n### Supported tabular/top level operators\nHere's the list of KQL tabular operators supported by Resource Graph with specific samples:"",""updatedAt"":""2025-07-23T22:09:00Z""}]}}}]},{""createdAt"":""2025-12-26T07:29:08.965362Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_05a655b6422a42b7"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""result"":""{\""message\"":\""Please provide the workload configuration database schema (get_workload_configuration_database_schema).\"",\""artifacts\"":[]}""}}]},{""createdAt"":""2025-12-26T07:29:09.965367Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""text"",""text"":""To proceed with detecting configuration drifts for your SAP Workload BB4 in subscription 7235b861-9c47-4957-8841-e5f0b305a68a, please provide the workload configuration database schema. This information is necessary to identify any deviations or drifts in the configuration.""}]}]","[{""name"":""provide_azure_docs_assistance"",""description"":""Can provide general purpose answers and advice about Microsoft Azure. You should prefer calls to other functions that can act on the user's behalf. Only call this function for general purpose inquiries."",""parameters"":{""type"":""object"",""properties"":{""question"":{""description"":""Question that needs to be answered based on the user intent."",""type"":""string""}},""required"":[""question""]}},{""name"":""WorkloadConfigurationDriftDetection"",""description"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list."",""parameters"":{""type"":""object"",""properties"":{""message"":{""type"":""string"",""description"":""The message or request to send to the agent""}},""required"":[""message""]}}]","[""WorkloadConfigurationDriftDetection"",""provide_azure_docs_assistance""]","1","89072","6/7","Pass","User wanted to detect configuration drifts for their SAP workload. The agent requested additional information (database schema) necessary to proceed, moving towards resolution but not fully completing the intent.","Pass","The RESPONSE partially addresses the QUERY but fails to follow the logical sequence required to construct and execute the KQL query. It also violates the instruction to avoid asking the user for additional information, leading to a lack of coherence.","Pass","The response is relevant as it addresses the user's query about detecting configuration drifts for their SAP workload. However, it is incomplete because it does not explain why the workload configuration database schema is needed or how to provide it.","Pass","The RESPONSE is fully grounded in the QUERY and tool results, providing a correct and complete answer without adding extraneous or incorrect information.","Fail","Let's think step by step: The user's query is to detect and list configuration drifts for the SAP workload named 'BB4' in a specific subscription. Based on the tool definitions, the correct orchestration flow involves calling the 'provide_azure_docs_assistance' tool to gather KQL guidance, the 'get_workload_configuration_database_schema' tool to retrieve the schema, constructing a valid KQL query, verifying it using 'verify_drift_query', and finally executing it using 'execute_azure_resource_graph_query'. The agent made two tool calls: one to 'WorkloadConfigurationDriftDetection' and another to 'provide_azure_docs_assistance'. The first tool call to 'WorkloadConfigurationDriftDetection' was incorrect because it bypassed the required steps of retrieving the schema and constructing a valid query. The second tool call to 'provide_azure_docs_assistance' was correct and relevant for gathering KQL guidance. However, the agent missed several necessary tool calls, including 'get_workload_configuration_database_schema', 'verify_drift_query', and 'execute_azure_resource_graph_query'. Additionally, the parameters for the first tool call were not grounded in the defined orchestration flow, leading to an error response. Therefore, the tool calls were partially relevant but incomplete and incorrectly executed.","Pass","The assistant correctly identified required actions from the system instructions and began the process of fulfilling the user request. It acknowledged the need for the workload configuration database schema, which is necessary to proceed with constructing and verifying the KQL query. It also conducted a relevant tool call to gather authoritative Azure documentation, aligning with the defined workflow. No material failures were observed in goal adherence, rule adherence, or procedural adherence as the assistant followed the outlined steps and did not claim external actions or results beyond what tool calls confirmed.","Pass","The RESPONSE is clear, grammatically correct, and coherent, with adequate vocabulary and sentence structure suitable for the technical context. It aligns with the definition of Competent Fluency.","-","1","-"
"2","8WGSnyqAIMh5Zfi1K78sWC-us","[{""role"":""system"",""content"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list.""},{""createdAt"":""2025-12-26T07:29:03.965491Z"",""role"":""user"",""content"":[{""type"":""text"",""text"":""Are there any configuration issues on my Production SAP systems that can impact their performance?""}]}]","[{""createdAt"":""2025-12-26T07:29:04.965514Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_c7d747d3ac6c43cd"",""name"":""WorkloadConfigurationDriftDetection"",""arguments"":{""message"":""Please analyze configuration drifts and configuration deviations for the user's Production SAP systems and report any configuration issues that could impact performance. The user did not provide resource or subscription IDs; if you need specific subscription(s) or Azure resource IDs to proceed, ask for them explicitly.""}}]},{""createdAt"":""2025-12-26T07:29:06.965527Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_ebfc19b730b4444d"",""name"":""provide_azure_docs_assistance"",""arguments"":{""question"":""Please provide authoritative Azure documentation and guidance for Kusto Query Language (KQL) and Azure Resource Graph query formation, especially for querying the ExtensibilityResources table. Include examples of: - Filtering nested array fields (e.g., evaluationResults.configurationDeviation) - Projecting specific nested array elements such as evaluationResults[].name, description, checkCategory, impactLevel - Filtering using substring matches against resource name or workloadSystemIdentifier - Best practices for filtering by resource type and environment tag (e.g., environment == 'Production') - Any limitations or recommended approaches when querying large arrays or using mv-expand/mv-apply.\n\nI will use this information to construct a KQL query that: projects evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId; always filters on type and evaluationResults.configurationDeviation; and optionally filters by a workload identifier substring in name or workloadSystemIdentifier.""}}]},{""createdAt"":""2025-12-26T07:29:07.965559Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_ebfc19b730b4444d"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""Data"":{""value"":[{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/servers/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.5827472,""title"":""Azure Resource Graph sample queries for Azure Arc-enabled servers"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc-enabled servers\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. You create queries by using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis article provides a list of sample Azure Resource Graph queries for Azure Arc-enabled servers. These queries target the `microsoft.hybridcompute/machines` resource type and return information such as domain membership, installed extensions, agent versions, and OS details. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal by using the Resource Graph Explorer. Modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-12-19T05:31:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.5572255,""title"":""Azure Resource Graph sample queries for Azure Arc"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. Queries are created using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis page provides a list of sample Azure Resource Graph queries for Azure Arc. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal using the Resource Graph Explorer. Feel free to modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-07-23T05:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4579742,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\nThe query language for the Azure Resource Graph supports many operators and functions. Each work and operate based on [Kusto Query Language (KQL)](/en-us/azure/data-explorer/kusto/query/index). To learn about the query language used by Resource Graph, start with the [tutorial for KQL](/en-us/azure/data-explorer/kusto/query/tutorial).\nThis article covers the language components supported by Resource Graph:\n1. Understanding the Azure Resource Graph query language\n1.1. Resource Graph tables\n1.2. Extended properties\n1.3. Resource Graph custom language elements\n1.3.1. Shared query syntax (preview)\n1.4. Supported KQL language elements\n1.4.1. Supported tabular/top level operators\n1.5. Query scope\n1.6. Escape characters\n1.7. Next steps"",""updatedAt"":""2025-07-23T22:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#supported-kql-language-elements"",""score"":2.4370604,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\n## Supported KQL language elements\n| KQL | Resource Graph sample query | Notes| \n|  --- | --- | ---  |\n| [count](/en-us/azure/data-explorer/kusto/query/countoperator) | [Count key vaults](../samples/starter#count-key-vault-resources) |  |\n| [distinct](/en-us/azure/data-explorer/kusto/query/distinctoperator) | [Show resources that contain storage](../samples/starter#show-resources-that-contain-storage) |  |\n| [extend](/en-us/azure/data-explorer/kusto/query/extendoperator) | [Count virtual machines by OS type](../samples/starter#count-virtual-machines-by-os-type) |  |\n| [join](/en-us/azure/data-explorer/kusto/query/joinoperator) | [Key vault with subscription name](../samples/advanced#key-vaults-with-subscription-name) | Join flavors supported: [innerunique](/en-us/azure/data-explorer/kusto/query/joinoperator#default-join-flavor), [inner](/en-us/azure/data-explorer/kusto/query/joinoperator#inner-join), [leftouter](/en-us/azure/data-explorer/kusto/query/joinoperator#left-outer-join), and [fullouter](/en-us/azure/data-explorer/kusto/query/join-fullouter). Limit of three `join` or `union` operations (or a combination of the two) in a single query, counted together, one of which might be a cross-table join. If all cross-table `join` use is between *Resource* and *ResourceContainers*, then three cross-table `join` are allowed. Custom join strategies, such as broadcast join, aren't allowed. For which tables can use `join`, go to Resource Graph tables. |"",""updatedAt"":""2025-07-23T22:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#supported-kql-language-elements"",""score"":2.4335158,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\n## Supported KQL language elements\nResource Graph supports a subset of KQL [data types](/en-us/azure/data-explorer/kusto/query/scalar-data-types/), [scalar functions](/en-us/azure/data-explorer/kusto/query/scalarfunctions), [scalar operators](/en-us/azure/data-explorer/kusto/query/binoperators), and [aggregation functions](/en-us/kusto/query/aggregation-functions). Specific [tabular operators](/en-us/azure/data-explorer/kusto/query/queries) are supported by Resource Graph, some of which have different behaviors.\n### Supported tabular/top level operators\nHere's the list of KQL tabular operators supported by Resource Graph with specific samples:"",""updatedAt"":""2025-07-23T22:09:00Z""}]}}}]},{""createdAt"":""2025-12-26T07:29:08.965581Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_c7d747d3ac6c43cd"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""result"":""{\""message\"":\""Clarification required: Please provide the schema for the workload configuration drift database (the ExtensibilityResources table). Include the column names and types — specifically the structure of the evaluationResults array and the configurationDeviation field — so I can construct the KQL query.\"",\""artifacts\"":[]}""}}]},{""createdAt"":""2025-12-26T07:29:09.965587Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""text"",""text"":""To proceed with identifying any configuration issues on your Production SAP systems that might impact performance, I need more information. Please provide the schema for the workload configuration drift database, specifically the structure of the `ExtensibilityResources` table, including column names and types, as well as the structure of the `evaluationResults` array and the `configurationDeviation` field. This will help in constructing the necessary query to analyze the configuration drifts.""}]}]","[{""name"":""provide_azure_docs_assistance"",""description"":""Can provide general purpose answers and advice about Microsoft Azure. You should prefer calls to other functions that can act on the user's behalf. Only call this function for general purpose inquiries."",""parameters"":{""type"":""object"",""properties"":{""question"":{""description"":""Question that needs to be answered based on the user intent."",""type"":""string""}},""required"":[""question""]}},{""name"":""WorkloadConfigurationDriftDetection"",""description"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list."",""parameters"":{""type"":""object"",""properties"":{""message"":{""type"":""string"",""description"":""The message or request to send to the agent""}},""required"":[""message""]}}]","[""WorkloadConfigurationDriftDetection"",""provide_azure_docs_assistance""]","1","124108","4/7","Fail","User wanted to identify configuration issues impacting performance on Production SAP systems. Agent requested specific database schema details without addressing the intent directly or offering actionable insights, resulting in a poor resolution.","Pass","The RESPONSE partially addresses the QUERY by attempting to gather relevant information and tools but fails to follow the orchestration flow properly, lacks logical organization, and requires the user to provide information that should have been inferred or retrieved automatically. The connections between the steps are unclear, and the overall flow is disjointed.","Fail","The response is off-topic and does not address the user's query about configuration issues impacting SAP system performance. Instead, it requests unrelated database schema details.","Pass","The RESPONSE does not provide any grounded information or actionable insights based on the QUERY, instead asking for clarification to proceed.","Fail","Let's think step by step: The user's query is about identifying configuration issues on their Production SAP systems that could impact performance. Based on the tool definitions, the agent should have followed the orchestration flow: (1) Call the 'provide_azure_docs_assistance' tool to gather KQL syntax and query formation guidance, (2) Call the 'get_workload_configuration_database_schema' tool to retrieve the schema for the ExtensibilityResources table, (3) Construct a valid KQL query with the required filters and projections, (4) Verify the query using 'verify_drift_query', and (5) Execute the query using 'execute_azure_resource_graph_query'. However, the agent made two tool calls: one to 'WorkloadConfigurationDriftDetection' with an incomplete and ungrounded message, and another to 'provide_azure_docs_assistance' for KQL guidance. The first tool call failed because it lacked the required schema information, which should have been retrieved using the 'get_workload_configuration_database_schema' tool. The second tool call was correct and relevant. However, the agent failed to make the necessary call to 'get_workload_configuration_database_schema' and did not proceed with constructing or verifying the KQL query. Additionally, the agent's message in the first tool call was not grounded in the conversation, as it fabricated a request to ask the user for subscription IDs, which contradicts the instructions in the tool definition. Therefore, the tool calls were partially relevant but incomplete and contained parameter errors.","Pass","The assistant correctly identified that additional information, particularly the schema of the workload configuration drift database and the structure of the ExtensibilityResources table, is required to proceed. It also made appropriate calls to gather Azure documentation on KQL and query formation. While it did not produce the user's requested result, the assistant followed the required steps and asked for clarification where necessary, allowing progress without speculative or unsafe actions. No rules, procedural, or goal adherence violations were found.","Pass","The RESPONSE is well-articulated, uses appropriate technical language, and conveys ideas clearly and logically, with no major errors affecting readability.","-","2","-"
"3","Abq25qwThSY2RtmekiC953-us","[{""role"":""system"",""content"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list.""},{""createdAt"":""2025-12-26T07:29:03.965672Z"",""role"":""user"",""content"":[{""type"":""text"",""text"":""Provide the resolution steps for all configuration checks for my workload BB4""}]}]","[{""createdAt"":""2025-12-26T07:29:04.965687Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_cf252bead2c84979"",""name"":""WorkloadConfigurationDriftDetection"",""arguments"":{""message"":""Provide the resolution steps for all configuration checks for my workload BB4.""}}]},{""createdAt"":""2025-12-26T07:29:06.965699Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_8488171831044200"",""name"":""provide_azure_docs_assistance"",""arguments"":{""question"":""Provide authoritative Azure documentation and examples for forming Kusto Query Language (KQL) queries against Azure Resource Graph (ARG), specifically: how to filter and project nested array fields (e.g., properties.evaluationResults[]), examples for filtering where evaluationResults.configurationDeviation is true, best practices for filtering on resource type and workload identifier (which may be substring-matched against the name or the workloadSystemIdentifier column), and guidance on projecting only specific nested fields (evaluationResults[].name, description, checkCategory, impactLevel) along with workloadSystemIdentifier, componentType, componentName, environment, and subscriptionId. Also include any ARG limits or syntax details relevant to projecting arrays and using mv-expand or mv-apply.""}}]},{""createdAt"":""2025-12-26T07:29:07.965737Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_8488171831044200"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""Data"":{""value"":[{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/kubernetes/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4741025,""title"":""Azure Resource Graph sample queries for Azure Arc-enabled Kubernetes"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc-enabled Kubernetes\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. Queries are created using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis page provides a list of sample Azure Resource Graph queries for Azure Arc-enabled Kubernetes. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal using the Resource Graph Explorer. Feel free to modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-06-17T22:01:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/servers/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4491124,""title"":""Azure Resource Graph sample queries for Azure Arc-enabled servers"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc-enabled servers\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. You create queries by using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis article provides a list of sample Azure Resource Graph queries for Azure Arc-enabled servers. These queries target the `microsoft.hybridcompute/machines` resource type and return information such as domain membership, installed extensions, agent versions, and OS details. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal by using the Resource Graph Explorer. Modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-12-19T05:31:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4390101,""title"":""Azure Resource Graph sample queries for Azure Arc"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. Queries are created using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis page provides a list of sample Azure Resource Graph queries for Azure Arc. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal using the Resource Graph Explorer. Feel free to modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-07-23T05:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/service-health/resource-graph-health-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4319208,""title"":""Azure Resource Graph sample queries for Azure Resource Health"",""chunk"":""# Azure Resource Graph sample queries for Azure Resource Health\nThis page is a collection of [Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) sample queries for Azure Resource Health.\nNote\nAfter each query, you should see the updated results within 5 minutes in general.\n## Overview\nThis page helps you monitor and understand the health of your Azure services and resources using Kusto Query Language (KQL) through Azure Resource Graph.\nIt includes sample queries specifically for Azure Resource Health."",""updatedAt"":""2025-08-08T17:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-monitor/logs/azure-monitor-data-explorer-proxy?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#query-data-in-azure-resource-graph-by-using-arg-preview"",""score"":2.4127793,""title"":""Correlate data in Azure Data Explorer and Azure Resource Graph with data in a Log Analytics workspace"",""chunk"":""# Correlate data in Azure Data Explorer and Azure Resource Graph with data in a Log Analytics workspace\n## Query data in Azure Resource Graph by using arg() (Preview)\nEnter the `arg(\""\"")` pattern, followed by the Azure Resource Graph table name.\nFor example:\n```kusto\narg(\""\"").<Azure-Resource-Graph-table-name>\n```\nTip\nThe `arg()` operator is now available for advanced hunting in the Microsoft Defender portal. This feature allows results that query Microsoft Sentinel tables. For more information, see [Azure Resource Graph queries in advanced hunting](/en-us/defender-xdr/advanced-hunting-defender-use-custom-rules#use-arg-operator-for-azure-resource-graph-queries).\nHere are some sample Azure Log Analytics queries that use the new Azure Resource Graph cross-service query capabilities:\n### Example: Filter Log Analytics query based on the results of an Azure Resource Graph query\n```kusto\narg(\""\"").Resources \n| where type == \""microsoft.compute/virtualmachines\"" and properties.hardwareProfile.vmSize startswith \""Standard_D\""\n| join (\n   Heartbeat\n   | where TimeGenerated > ago(1d)\n   | distinct Computer\n)\non $left.name == $right.Computer\n```\n### Examples: Create an alert rule that applies only to certain resources taken from an arg() query\nExclude resources based on tags. For example, don't trigger alerts for VMs with a `Test` tag.\n```kusto\narg(\""\"").Resources\n| where tags.environment=~'Test'\n| project name\n```\nRetrieve performance data related to CPU utilization and filter to resources with the `prod` tag.\n```kusto\nInsightsMetrics\n| where Name == \""UtilizationPercentage\""\n| lookup (\n   arg(\""\"").Resources \n   | where type == 'microsoft.compute/virtualmachines' \n   | project _ResourceId=tolower(id), tags\n)\non _ResourceId\n| where tostring(tags.Env) == \""Prod\""\n```\n### More example use cases\n1. Use a tag to determine whether VMs should be running 24x7 or should be shut down at night.\n2. Show alerts on any server that contains a defined number of cores."",""updatedAt"":""2025-08-29T22:11:00Z""}]}}}]},{""createdAt"":""2025-12-26T07:29:08.965749Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_cf252bead2c84979"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""result"":""{\""message\"":\""Clarification required: workload configuration schema missing.\"",\""artifacts\"":[] }""}}]},{""createdAt"":""2025-12-26T07:29:09.965755Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""text"",""text"":""It seems that the configuration schema for your workload BB4 is missing. Could you provide more details or clarify the specific configuration checks you are referring to? This will help in providing the appropriate resolution steps.""}]}]","[{""name"":""provide_azure_docs_assistance"",""description"":""Can provide general purpose answers and advice about Microsoft Azure. You should prefer calls to other functions that can act on the user's behalf. Only call this function for general purpose inquiries."",""parameters"":{""type"":""object"",""properties"":{""question"":{""description"":""Question that needs to be answered based on the user intent."",""type"":""string""}},""required"":[""question""]}},{""name"":""WorkloadConfigurationDriftDetection"",""description"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list."",""parameters"":{""type"":""object"",""properties"":{""message"":{""type"":""string"",""description"":""The message or request to send to the agent""}},""required"":[""message""]}}]","[""WorkloadConfigurationDriftDetection"",""provide_azure_docs_assistance""]","1","106087","4/7","Fail","User wanted resolution steps for configuration checks for workload BB4. Agent requested clarification instead of providing any steps, failing to progress towards resolving the intent, leaving the request unaddressed.","Pass","The RESPONSE partially addresses the QUERY by initiating relevant tool calls but fails to provide a coherent or complete answer. The logical flow is disrupted, and the user is left with an incomplete and unclear response.","Fail","The response is related to the user's query but does not provide any resolution steps as requested. Instead, it asks for clarification, making it incomplete and unhelpful for the user's immediate need.","Pass","The RESPONSE is grounded in the tool results and appropriately requests clarification due to missing schema, but it does not provide resolution steps as requested in the QUERY, making it incomplete.","Fail","Let's think step by step: The user's query was to provide resolution steps for all configuration checks for their workload BB4. Based on the tool definitions, the agent should have followed the orchestration flow for the WorkloadConfigurationDriftDetection tool. This involves calling the provide_azure_docs_assistance tool to gather KQL documentation, calling the get_workload_configuration_database_schema tool to retrieve the schema, constructing a KQL query, verifying it using the verify_drift_query tool, and finally executing it using the execute_azure_resource_graph_query tool. However, the agent made only two tool calls: one to WorkloadConfigurationDriftDetection and another to provide_azure_docs_assistance. The WorkloadConfigurationDriftDetection tool call failed due to missing workload configuration schema, and the agent did not attempt to retrieve the schema using the get_workload_configuration_database_schema tool, which was necessary to proceed. Additionally, the agent did not attempt to construct or verify a KQL query, nor did it execute the query. Therefore, the tool calls were incomplete and did not address the user's query effectively. The parameters passed to the tools were grounded in the conversation, but the overall execution was incomplete and did not fulfill the user's request.","Pass","The assistant attempted to address the user's request by initiating appropriate tools and asking for clarification about the missing workload configuration schema for BB4, which was needed to proceed with the resolution steps. This aligns with the goal and respects constraints, as clarification was required to avoid ambiguity. The response followed necessary workflows by invoking the recommend plugins and referencing Azure documentation, adhering to procedural requirements. No violations of safety, privacy, or presentation rules are evident from the tool results and response structure.","Pass","The RESPONSE demonstrates clear communication with correct grammar and adequate vocabulary. It is coherent and easy to understand, but it lacks advanced sentence complexity and varied vocabulary that would elevate it to higher fluency levels.","-","3","-"
"4","5R6pdDysCN7LeyzTArLQ6g-us","[{""role"":""system"",""content"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list.""},{""createdAt"":""2025-12-26T07:29:03.965838Z"",""role"":""user"",""content"":[{""type"":""text"",""text"":""show me the resolution steps for Azure-Network-Accelerated-Networking-Status in SAP Workload BB4""}]}]","[{""createdAt"":""2025-12-26T07:29:04.965853Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_1ba4eb8f5e94408d"",""name"":""WorkloadConfigurationDriftDetection"",""arguments"":{""message"":""Please provide the resolution steps for the check 'Azure-Network-Accelerated-Networking-Status' for SAP workload 'BB4'. Return the findings and the step-by-step resolution actions.""}}]},{""createdAt"":""2025-12-26T07:29:06.965866Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_5443dbf75bcd49ae"",""name"":""provide_azure_docs_assistance"",""arguments"":{""question"":""Provide authoritative Azure documentation and guidance about Kusto Query Language (KQL) syntax and best practices for constructing queries against the Azure Resource Graph, including how to filter, project arrays (evaluationResults[]), use contains/substring matching on name or workloadSystemIdentifier, and examples of projecting nested fields and limiting results. Also include guidance about required query structure for ExtensibilityResources table when filtering by columns: type, evaluationResults.configurationDeviation, and projecting evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.""}}]},{""createdAt"":""2025-12-26T07:29:07.965900Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_5443dbf75bcd49ae"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""Data"":{""value"":[{""url"":""https://learn.microsoft.com/en-us/azure/service-health/resource-graph-health-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4212866,""title"":""Azure Resource Graph sample queries for Azure Resource Health"",""chunk"":""# Azure Resource Graph sample queries for Azure Resource Health\nThis page is a collection of [Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) sample queries for Azure Resource Health.\nNote\nAfter each query, you should see the updated results within 5 minutes in general.\n## Overview\nThis page helps you monitor and understand the health of your Azure services and resources using Kusto Query Language (KQL) through Azure Resource Graph.\nIt includes sample queries specifically for Azure Resource Health."",""updatedAt"":""2025-08-08T17:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/servers/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.3833585,""title"":""Azure Resource Graph sample queries for Azure Arc-enabled servers"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc-enabled servers\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. You create queries by using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis article provides a list of sample Azure Resource Graph queries for Azure Arc-enabled servers. These queries target the `microsoft.hybridcompute/machines` resource type and return information such as domain membership, installed extensions, agent versions, and OS details. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal by using the Resource Graph Explorer. Modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-12-19T05:31:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.3643942,""title"":""Azure Resource Graph sample queries for Azure Arc"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. Queries are created using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis page provides a list of sample Azure Resource Graph queries for Azure Arc. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal using the Resource Graph Explorer. Feel free to modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-07-23T05:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/overview?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#how-resource-graph-is-kept-current"",""score"":2.3126419,""title"":""What is Azure Resource Graph?"",""chunk"":""# What is Azure Resource Graph?\n## How Resource Graph is kept current\nWhen an Azure resource is updated, Azure Resource Manager notifies Azure Resource Graph about the change. Azure Resource Graph then updates its database. Azure Resource Graph also does a regular *full scan*. This scan ensures that Azure Resource Graph data is current if there are missed notifications. Or when a resource is updated outside of Azure Resource Manager.\nNote\nResource Graph uses a `GET` to the latest non-preview application programming interface (API) of each resource provider to gather properties and values. As a result, the property expected may not be available. In some cases, the API version used has been overridden to provide more current or widely used properties in the results. See the [Show API version for each resource type](samples/advanced#show-api-version-for-each-resource-type) sample for a complete list in your environment.\n## The query language\nNow that you have a better understanding of what Azure Resource Graph is, let's dive into how to construct queries.\nIt's important to understand that Azure Resource Graph's query language is based on the [Kusto Query Language (KQL)](/en-us/azure/data-explorer/data-explorer-overview) used by Azure Data Explorer.\nFirst, for details on operations and functions that can be used with Azure Resource Graph, see [Resource Graph query language](concepts/query-language). To browse resources, see [explore resources](concepts/explore-resources)."",""updatedAt"":""2024-08-27T22:05:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.308654,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\nThe query language for the Azure Resource Graph supports many operators and functions. Each work and operate based on [Kusto Query Language (KQL)](/en-us/azure/data-explorer/kusto/query/index). To learn about the query language used by Resource Graph, start with the [tutorial for KQL](/en-us/azure/data-explorer/kusto/query/tutorial).\nThis article covers the language components supported by Resource Graph:\n1. Understanding the Azure Resource Graph query language\n1.1. Resource Graph tables\n1.2. Extended properties\n1.3. Resource Graph custom language elements\n1.3.1. Shared query syntax (preview)\n1.4. Supported KQL language elements\n1.4.1. Supported tabular/top level operators\n1.5. Query scope\n1.6. Escape characters\n1.7. Next steps"",""updatedAt"":""2025-07-23T22:09:00Z""}]}}}]},{""createdAt"":""2025-12-26T07:29:08.965913Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_1ba4eb8f5e94408d"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""result"":""{\""message\"":\""Please provide the workload configuration database schema for the ExtensibilityResources table.\"",\""artifacts\"":[]}""}}]},{""createdAt"":""2025-12-26T07:29:09.965918Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""text"",""text"":""The resolution steps for the 'Azure-Network-Accelerated-Networking-Status' in SAP workload 'BB4' are not available from the current data. If you have specific details or need further assistance, please let me know!""}]}]","[{""name"":""provide_azure_docs_assistance"",""description"":""Can provide general purpose answers and advice about Microsoft Azure. You should prefer calls to other functions that can act on the user's behalf. Only call this function for general purpose inquiries."",""parameters"":{""type"":""object"",""properties"":{""question"":{""description"":""Question that needs to be answered based on the user intent."",""type"":""string""}},""required"":[""question""]}},{""name"":""WorkloadConfigurationDriftDetection"",""description"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list."",""parameters"":{""type"":""object"",""properties"":{""message"":{""type"":""string"",""description"":""The message or request to send to the agent""}},""required"":[""message""]}}]","[""WorkloadConfigurationDriftDetection"",""provide_azure_docs_assistance""]","1","83684","1/7","Fail","User wanted resolution steps for 'Azure-Network-Accelerated-Networking-Status' in SAP workload 'BB4'. Agent stated the steps are unavailable but did not offer alternatives or actionable next steps, leaving the intent partially unresolved.","Fail","The RESPONSE is poorly coherent as it does not logically organize the information or provide a clear resolution to the QUERY. It includes fragmented steps and fails to connect them meaningfully to the user's request.","Fail","The response acknowledges the user's query but fails to provide any resolution steps or meaningful information. It is related to the query but unhelpful, as it only states that the requested information is unavailable.","Fail","The RESPONSE does not provide a grounded answer to the QUERY and fails to utilize the tool results effectively, making it unrelated to the QUERY's intent.","Fail","Let's think step by step: The user's query is asking for resolution steps for a specific check ('Azure-Network-Accelerated-Networking-Status') in the SAP workload 'BB4'. Based on the tool definitions, the WorkloadConfigurationDriftDetection tool is responsible for detecting configuration drifts and orchestrating the pipeline to construct and execute KQL queries. However, the tool call made to WorkloadConfigurationDriftDetection does not align with the orchestration flow defined in the tool's description. Instead of following the steps to gather schema, construct a KQL query, verify it, and execute it, the agent directly requested resolution steps, which is not the intended use of this tool. Additionally, the provide_azure_docs_assistance tool was called to retrieve documentation about KQL syntax, which is relevant to constructing queries but not directly relevant to the user's query about resolution steps. Furthermore, the agent failed to make necessary calls to other tools, such as get_workload_configuration_database_schema, verify_drift_query, and execute_azure_resource_graph_query, which are required to fulfill the user's request. Therefore, the tool calls are partially relevant but do not fully address the user's query, and there are missing tool calls.","Fail","The assistant did not adhere to the specified task and orchestration flow to detect configuration drifts through constructing and running a KQL query based on the provided schema. Instead, it attempted to obtain resolution steps for a specific check, which was unrelated to the defined task scope of detecting configuration drifts. Additionally, the assistant failed to perform all required workflow steps outlined in the SYSTEM_MESSAGE, such as acquiring the schema for the table, constructing the KQL query, verifying the query, and executing it through the provided plugins. This resulted in the assistant's response being off-scope with incomplete deliverables and a clear procedural failure, as the required steps for detecting configuration drifts were not followed or referenced appropriately.","Pass","The RESPONSE is clear and understandable with correct grammar and adequate vocabulary, but it lacks complexity and variety in sentence structure and expression, placing it at a competent level of fluency.","-","4","-"
"5","5R6pdDysCN7LeyzTArLQ6g-us_with_reasoning","[{""role"":""system"",""content"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list.""},{""createdAt"":""2025-12-26T07:29:03.965838Z"",""role"":""user"",""content"":[{""type"":""text"",""text"":""show me the resolution steps for Azure-Network-Accelerated-Networking-Status in SAP Workload BB4""}]}]","[{""createdAt"":""2025-12-26T07:29:04.965853Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_1ba4eb8f5e94408d"",""name"":""WorkloadConfigurationDriftDetection"",""arguments"":{""message"":""Please provide the resolution steps for the check 'Azure-Network-Accelerated-Networking-Status' for SAP workload 'BB4'. Return the findings and the step-by-step resolution actions.""}}]},{""createdAt"":""2025-12-26T07:29:06.965866Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""tool_call"",""tool_call_id"":""call_5443dbf75bcd49ae"",""name"":""provide_azure_docs_assistance"",""arguments"":{""question"":""Provide authoritative Azure documentation and guidance about Kusto Query Language (KQL) syntax and best practices for constructing queries against the Azure Resource Graph, including how to filter, project arrays (evaluationResults[]), use contains/substring matching on name or workloadSystemIdentifier, and examples of projecting nested fields and limiting results. Also include guidance about required query structure for ExtensibilityResources table when filtering by columns: type, evaluationResults.configurationDeviation, and projecting evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.""}}]},{""createdAt"":""2025-12-26T07:29:07.965900Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_5443dbf75bcd49ae"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""Data"":{""value"":[{""url"":""https://learn.microsoft.com/en-us/azure/service-health/resource-graph-health-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.4212866,""title"":""Azure Resource Graph sample queries for Azure Resource Health"",""chunk"":""# Azure Resource Graph sample queries for Azure Resource Health\nThis page is a collection of [Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) sample queries for Azure Resource Health.\nNote\nAfter each query, you should see the updated results within 5 minutes in general.\n## Overview\nThis page helps you monitor and understand the health of your Azure services and resources using Kusto Query Language (KQL) through Azure Resource Graph.\nIt includes sample queries specifically for Azure Resource Health."",""updatedAt"":""2025-08-08T17:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/servers/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.3833585,""title"":""Azure Resource Graph sample queries for Azure Arc-enabled servers"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc-enabled servers\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. You create queries by using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis article provides a list of sample Azure Resource Graph queries for Azure Arc-enabled servers. These queries target the `microsoft.hybridcompute/machines` resource type and return information such as domain membership, installed extensions, agent versions, and OS details. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal by using the Resource Graph Explorer. Modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-12-19T05:31:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/azure-arc/resource-graph-samples?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.3643942,""title"":""Azure Resource Graph sample queries for Azure Arc"",""chunk"":""# Azure Resource Graph sample queries for Azure Arc\n[Azure Resource Graph](/en-us/azure/governance/resource-graph/overview) is an Azure service that lets you query at scale, helping you effectively govern your environment. Queries are created using Kusto Query Language (KQL). For more information, see [Understanding the Azure Resource Graph query language](/en-us/azure/governance/resource-graph/concepts/query-language).\nThis page provides a list of sample Azure Resource Graph queries for Azure Arc. You can run these queries through Azure PowerShell or Azure CLI, or in the Azure portal using the Resource Graph Explorer. Feel free to modify the queries to suit your needs.\nTip\nYou can use Microsoft Copilot in Azure to author Azure Resource Graph queries using natural language. For more information, see [Get resource information using Microsoft Copilot in Azure](/en-us/azure/copilot/get-information-resource-graph)."",""updatedAt"":""2025-07-23T05:09:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/overview?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure#how-resource-graph-is-kept-current"",""score"":2.3126419,""title"":""What is Azure Resource Graph?"",""chunk"":""# What is Azure Resource Graph?\n## How Resource Graph is kept current\nWhen an Azure resource is updated, Azure Resource Manager notifies Azure Resource Graph about the change. Azure Resource Graph then updates its database. Azure Resource Graph also does a regular *full scan*. This scan ensures that Azure Resource Graph data is current if there are missed notifications. Or when a resource is updated outside of Azure Resource Manager.\nNote\nResource Graph uses a `GET` to the latest non-preview application programming interface (API) of each resource provider to gather properties and values. As a result, the property expected may not be available. In some cases, the API version used has been overridden to provide more current or widely used properties in the results. See the [Show API version for each resource type](samples/advanced#show-api-version-for-each-resource-type) sample for a complete list in your environment.\n## The query language\nNow that you have a better understanding of what Azure Resource Graph is, let's dive into how to construct queries.\nIt's important to understand that Azure Resource Graph's query language is based on the [Kusto Query Language (KQL)](/en-us/azure/data-explorer/data-explorer-overview) used by Azure Data Explorer.\nFirst, for details on operations and functions that can be used with Azure Resource Graph, see [Resource Graph query language](concepts/query-language). To browse resources, see [explore resources](concepts/explore-resources)."",""updatedAt"":""2024-08-27T22:05:00Z""},{""url"":""https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language?wt.mc_id=knowledgesearch_inproduct_copilot-in-azure"",""score"":2.308654,""title"":""Understanding the Azure Resource Graph query language"",""chunk"":""# Understanding the Azure Resource Graph query language\nThe query language for the Azure Resource Graph supports many operators and functions. Each work and operate based on [Kusto Query Language (KQL)](/en-us/azure/data-explorer/kusto/query/index). To learn about the query language used by Resource Graph, start with the [tutorial for KQL](/en-us/azure/data-explorer/kusto/query/tutorial).\nThis article covers the language components supported by Resource Graph:\n1. Understanding the Azure Resource Graph query language\n1.1. Resource Graph tables\n1.2. Extended properties\n1.3. Resource Graph custom language elements\n1.3.1. Shared query syntax (preview)\n1.4. Supported KQL language elements\n1.4.1. Supported tabular/top level operators\n1.5. Query scope\n1.6. Escape characters\n1.7. Next steps"",""updatedAt"":""2025-07-23T22:09:00Z""}]}}}]},{""createdAt"":""2025-12-26T07:29:08.965913Z"",""run_id"":""run_0_1"",""tool_call_id"":""call_1ba4eb8f5e94408d"",""role"":""tool"",""content"":[{""type"":""tool_result"",""tool_result"":{""result"":""{\""message\"":\""Please provide the workload configuration database schema for the ExtensibilityResources table.\"",\""artifacts\"":[]}""}}]},{""createdAt"":""2025-12-26T07:29:09.965918Z"",""run_id"":""run_0_1"",""role"":""assistant"",""content"":[{""type"":""text"",""text"":""The resolution steps for the 'Azure-Network-Accelerated-Networking-Status' in SAP workload 'BB4' are not available from the current data. If you have specific details or need further assistance, please let me know!\n\n- The user asked for resolution steps for a specific configuration check within an SAP workload (BB4).\n- The WorkloadConfigurationDriftDetection agent is the specialized tool for identifying configuration deviations and providing resolution guidance for SAP workloads.\n- I will ask that agent to retrieve the resolution steps for the 'Azure-Network-Accelerated-Networking-Status' check on workload 'BB4'.\nI will retrieve Azure documentation to ensure the KQL query I construct follows Azure Resource Graph and KQL syntax, including handling arrays and nested fields, use of contains and substring matching, and projecting required fields. This will support building a query that filters on type and evaluationResults.configurationDeviation and projects the specified columns. I need to confirm array expansion syntax (mv-expand), projection of nested properties, and safe use of 'contains' vs '='. Also check best practices for limiting results and performance (limit, where filters first).""}]}]","[{""name"":""provide_azure_docs_assistance"",""description"":""Can provide general purpose answers and advice about Microsoft Azure. You should prefer calls to other functions that can act on the user's behalf. Only call this function for general purpose inquiries."",""parameters"":{""type"":""object"",""properties"":{""question"":{""description"":""Question that needs to be answered based on the user intent."",""type"":""string""}},""required"":[""question""]}},{""name"":""WorkloadConfigurationDriftDetection"",""description"":""# Role and Objective\nYou are the orchestrator for a pipeline of agents and plugins responsible for generating and running KQL queries to *detect configuration drifts* in workloads such as SAP and EHR. \n\n## Orchestration Flow\n1. Call the **provide_azure_docs_assistance** plugin to learn and gather authoritative Azure documentation about KQL syntax and query formation.\n2. Call the **get_workload_configuration_database_schema** plugin to get the schema for the workload configuration drift database.\n3. **Build the KQL query**: \n  - Analyze the schema and the user request to construct a valid KQL query (`query`) for **ExtensibilityResources** table. \n  - If the user’s prompt includes an workload identifier, it could be either substring of `name` OR `workloadSystemIdentifier` column. \n  - Always **add filters for following columns - type, evaluationResults.configurationDeviation**. \n  - Project only evaluationResults[].name, description, checkCategory, impactLevel, workloadSystemIdentifier, componentType, componentName, environment, subscriptionId.\n4. Build `selectedSubscriptions`- List of ALL user's Default or selected subcriptions:\n- Ensure all required parameters for tool calls are provided or can be reasonably inferred from the context.\n- Do not ask the user to specify the subscription.\n5. Call the plugin **verify_drift_query** and pass the constructed `query` along with the `selectedSubscriptions` to verify the query. Update the query based on response if query is incorrect. \n6. Call the plugin **execute_azure_resource_graph_query** and pass the constructed `query` along with the `selectedSubscriptions`. \n\n# Output Rules\n\n## If drifts found:\n1. **Always** show a summary of the drifts first – Total number of drifts, number of high impact drifts, number of drifts by `checkCategory`. When showing drifts for multiple system, the summary should include total number of high impact drifts on `Production` systems (if they exist), total number of drifts on prod systems vs `NonProduction`.\n2. **Always display first 10 rows in a Table**. Columns should be in the following order:\n   - **Check Id** → `properties.evaluationResults[].name`.\n   - **Description** → `properties.evaluationResults[].description`\n   - **Check Category** → `properties.evaluationResults[].checkCategory`\n   - **Impact Level** → `properties.evaluationResults[].impactLevel`\n   - If workload identifier was not passed by the user then also project **WVI Name** -> substring before first `-` hyphen in `name`column.\n   - **Component Type** → `properties.componentType`\n   - **Component Name** → `properties.componentName`\n   - **Environment** → `properties.environment`\n3. The artifact `config_drift_artifact` must include ALL rows returned by **execute_azure_resource_graph_query** plugin.\n\n## If No drifts found:\n1. Tell the User that query ran across their default subscriptions and returned no rows. \n2. Ask them to verify if their Workload's subscription is in the default subscription list."",""parameters"":{""type"":""object"",""properties"":{""message"":{""type"":""string"",""description"":""The message or request to send to the agent""}},""required"":[""message""]}}]","[""WorkloadConfigurationDriftDetection"",""provide_azure_docs_assistance""]","null","null","2/7","Fail","User wanted resolution steps for a specific Azure configuration issue in an SAP workload. The agent failed to provide any steps or actionable guidance, only stating the data was unavailable, leaving the intent unresolved.","Pass","The RESPONSE partially addresses the QUERY but lacks a clear and logical flow, making it difficult to follow and requiring the reader to infer connections. It includes extraneous details unrelated to the specific request.","Fail","The response acknowledges the user's query but fails to provide the requested resolution steps or any meaningful information. It instead describes a plan to retrieve the steps, which is not directly helpful to the user.","Fail","The RESPONSE attempts to address the QUERY but fails to provide the requested resolution steps and includes irrelevant information, making it unreliable and ungrounded.","Fail","Let's think step by step: The user's query is asking for resolution steps for a specific check ('Azure-Network-Accelerated-Networking-Status') in the SAP workload 'BB4'. Based on the tool definitions, the relevant tool to address this query is 'WorkloadConfigurationDriftDetection', which is designed to detect configuration drifts and provide relevant information. The first tool call made by the agent to 'WorkloadConfigurationDriftDetection' is partially relevant but incorrect because the tool's response indicates that it requires the workload configuration database schema, which was not provided. The second tool call to 'provide_azure_docs_assistance' is irrelevant to the user's query, as it retrieves general documentation about KQL syntax and query formation, which does not directly address the user's request for resolution steps. Additionally, the agent did not make the necessary calls to gather the workload configuration database schema or construct and execute the required KQL query to retrieve the requested resolution steps. Therefore, the tool calls are partially relevant but fail to address the user's query due to missing and incorrect tool calls.","Fail","The assistant did not fully adhere to the goal. The user's query requested resolution steps for a specific configuration check within the SAP workload 'BB4'. However, instead of constructing and executing the appropriate KQL query as defined in the SYSTEM_MESSAGE workflow to detect configuration drifts (steps 1-6), the assistant attempted to directly request resolution steps via the WorkloadConfigurationDriftDetection without explicitly running a query or analyzing data on configuration drifts. No steps of the prescribed orchestration flow were followed, and the user’s intent was therefore not achieved. There are no safety violations or concerns of misuse of tools, but the required tools were incorrectly prioritized and procedural adherence was lacking in this case.","Pass","The RESPONSE is clear and coherent, with adequate vocabulary and correct grammar. However, it lacks sentence complexity and variety, which prevents it from reaching higher fluency levels.","-","5","-"
